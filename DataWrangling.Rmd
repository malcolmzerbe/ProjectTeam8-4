---
title: "STAT 184 Project"
author: "ProjectTeam8-4"
date: "April 18, 2021"
output: html_notebook
---

#### Load Packages
```{r}
library(tidyverse) 
library(dplyr)
```

#### Read in Data and Convert Stat Files to Data Frames
```{r}
Memorial_Fantasy <- read.csv("Memorial_Fantasy.csv") # read in Memorial_Fantasy data

names(Memorial_Fantasy) <- c("Player", "Salary", "FPTS", "Tournament", "Par") # change Name variable to Player

Memorial_Stats <- read.delim("Memorial_Stats.txt") # read in Memorial_Stats data

Memorial_Stats <- data.frame(column = c(Memorial_Stats[,]))

Memorial_Stats <- Memorial_Stats %>%
  mutate(key = rep(c("Position", "Player", "Score", "Putt", "ARG", "App", "OTT", "T2G", "Total"), n()/9), id = cumsum(key == "Position")) %>%
  spread(key, column) # long to wide transformation; transpose every 9 rows of Memorial_Stats into a column

Memorial_Stats <- subset(Memorial_Stats, select = -id)
Memorial_Stats <- Memorial_Stats[, c("Position", "Player", "Score", "Putt", "ARG", "App", "OTT", "T2G", "Total")] # reorganize columns

#Bring in Schwab Fantasy
Schwab_Fantasy <- 
  read.csv("Schwab_Fantasy.csv")

names(Schwab_Fantasy) <- 
  c("Player", "Salary", "FPTS", "Tournament", "Par")

#Bring in Schwab Stats
Schwab_Stats <- 
  read.delim("Schwab_Stats.txt")

Schwab_Stats <-
  data.frame(column = c(Schwab_Stats[,]))

#Long to wide 
Schwab_Stats <- 
  Schwab_Stats %>%
  mutate(key = rep(c("Position", "Player", "Score", "Putt", "ARG", "App", "OTT", "T2G", "Total"), n()/9), id = cumsum(key == "Position")) %>%
  spread(key, column)

Schwab_Stats <-
  subset(Schwab_Stats, select = -id)

Schwab_Stats <-
  Schwab_Stats[, c("Position", "Player", "Score", "Putt", "ARG", "App", "OTT", "T2G", "Total")]

#PGA Data 
PGA_Fantasy <-
  read.csv("PGA_Fantasy.csv") #read in PGA Fantasy data

names(PGA_Fantasy) <-
    c("Player", "Salary", "FPTS", "Tournament", "Par") #set variable names for PGA Fantasy

PGA_Stats <-
  read.delim("PGA_Stats.txt") #read in PGA Stats data

PGA_Stats <-
  data.frame(column = c(PGA_Stats[,])) #create data frame

#PGA stats long to wide
PGA_Stats <- 
  PGA_Stats %>%
  mutate(key = rep(c("Position", "Player", "Score", "Putt", "ARG", "App", "OTT", "T2G", "Total"), n()/9), id = cumsum(key == "Position")) %>% 
  spread(key, column) 

PGA_Stats <-
  subset(PGA_Stats, select = -id)

PGA_Stats <-
  PGA_Stats[, c("Position", "Player", "Score", "Putt", "ARG", "App", "OTT", "T2G", "Total")] #reorganize columns of PGA data
```

#### Join Fantasy and Statistics to Create One Data Frame for Each of Three Tournaments
```{r}
Memorial <- full_join(Memorial_Stats, Memorial_Fantasy, by = "Player")

PGA <- 
  full_join(PGA_Stats, PGA_Fantasy, by = "Player")
  
Schwab <- full_join(Schwab_Stats, Schwab_Fantasy, by = "Player")
```

#### Combine the Three Tournament Data Frames to Final Data Frame 
```{r}
All_M_P_S <-
  rbind(Memorial, PGA, Schwab) #stack the 3 data frames together

Complete_M_P_S <-
  All_M_P_S[complete.cases(All_M_P_S[1:9]),] %>%#removes 4 rows that have NA in the first 9 variables from the stat data 
  #replace(Score, Score == "E", 0)
  mutate(Score = ifelse(as.character(Score) == "E",0, as.character(Score)))  #%>%#replace score E with 0 

#how I got top10 info......WE CAN PUT THIS ALL TOGETHER INTO ONE DATA FRAME IF U GUYS WANT 
top10 <- 
  Complete_M_P_S %>%
  select(Position, Player, Tournament) %>%
  mutate(top10= if_else(grepl("^[1-9]$|10|^T[1-9]$|T10",Position),"Yes", "No"))

#join the cobined 3 data frames to the top10 
top10Join <-
  Complete_M_P_S%>%
  left_join(top10, by = c("Player", "Position", "Tournament"))

#this gets the 3 Variables of Memorial, Charles Schwab, PGA Championship
PGA_M_CS_Score <-
  Complete_M_P_S %>%
  group_by(Player) %>%
  select(Player, Score, Tournament) 

PGA_M_CS_Score <-
  pivot_wider(PGA_M_CS_Score, names_from = Tournament, values_from = Score)

#join the top10 and the Scores
Join <-
  top10Join %>%
  left_join(PGA_M_CS_Score, by = "Player")

```



